---
import Layout from "../layouts/Layout.astro";

// Event data for timeline (unchanged)
const events = [
	{
		id: 1,
		icon: "",
		image: "/Media/LOGO_cff.png",
		cardTitle: "EVENT 1: BREAKIT",
		cardSubtitle: "Deconstruct. Stress Test. Redesign.",
		objectiveTitle: "ðŸŽ¯ Objective",
		objective: "Participants analyze and rethink real-world tech products, exposing system flaws and proposing grounded fixes â€” no code required.",
		color: "#a855f7",
	},
	{
		id: 2,
		icon: "",
		image: "/Media/TheDropt.png",
		cardTitle: "ðŸš€ EVENT 2: THE DROP",
		cardSubtitle: "Launch the Future. Even If It's Fake.",
		objectiveTitle: "ðŸŽ¯ Objective",
		objective: "Teams invent fictional future-tech products and launch them like real startups â€” blending storytelling, design, and satire.",
		color: "#d946ef",
	},
	{
		id: 3,
		icon: "",
		image: "/Media/Frame 87 (1).png",
		cardTitle: "Event 3 : Bet for Tech 3.0",
		objectiveTitle: "Objective",
		objective: "tests participants' coding skills, strategic thinking, and risk-taking ability by combining problem-solving with betting and psychological decision-making in a high-stakes competitive format.",
		color: "#ec4899",
	},
];

// Staggered bento hero data (Column 1, 2, 3)
const bentoCards = [
	// Column 1
	{ type: "text", title: "1", subtitle: "Event", column: 1, order: 1 },
	{ type: "image", image: events[0].image, title: events[0].cardTitle, column: 1, order: 2 },
	
	// Column 2 (Dominant center)
	{ type: "image", image: events[1].image, title: events[1].cardTitle, column: 2, order: 1, dominant: true },
	{ type: "text", title: "$500k", subtitle: "In Prizes", column: 2, order: 2 },
	
	// Column 3
	{ type: "text", title: "2000+", subtitle: "Participants", column: 3, order: 1 },
	{ type: "image", image: events[2].image, title: events[2].cardTitle, column: 3, order: 2 },
];
---

<Layout title="Events - Triverse">
	<main class="events-container">
		<!-- PHASE 1: STAGGERED BENTO HERO -->
		<section class="hero-section" id="staticHero">
			<div class="hero-content">
				<div class="hero-header">
					<h1 class="hero-title">The Events</h1>
					<p class="hero-subtitle">Premium competitions for bold creators</p>
				</div>

				<!-- Staggered Bento Layout (3 Columns) -->
				<div class="bento-grid">
					{/* Column 1: Text â†’ Image */}
					<div class="bento-column col-1">
						{/* Text Card */}
						<div class="bento-card text-card">
							<div class="card-content">
								<div class="stat-number">Day 1</div>
								<div class="stat-label">Event</div>
							</div>
						</div>

						{/* Image Card */}
						<div class="bento-card image-card">
							<img src={events[0].image} alt={events[0].cardTitle} />
							<div class="image-overlay">
								<p class="image-caption">{events[0].cardTitle}</p>
							</div>
						</div>
					</div>

					{/* Column 2: Image (Dominant) â†’ Text */}
					<div class="bento-column col-2">
						{/* Large Image Card (Dominant) */}
						<div class="bento-card image-card dominant">
							<img src={events[1].image} alt={events[1].cardTitle} />
							<div class="image-overlay">
								<p class="image-caption">{events[1].cardTitle}</p>
							</div>
						</div>

						{/* Text Card */}
						<div class="bento-card text-card small">
							<div class="card-content">
								<div class="stat-number">Day 2</div>
								<div class="stat-label">Event</div>
							</div>
						</div>
					</div>

					{/* Column 3: Text â†’ Image */}
					<div class="bento-column col-3">
						{/* Text Card */}
						<div class="bento-card text-card">
							<div class="card-content">
								<div class="stat-number">Day 3</div>
								<div class="stat-label">Event</div>
							</div>
						</div>

						{/* Image Card */}
						<div class="bento-card image-card">
							<img src={events[2].image} alt={events[2].cardTitle} />
							<div class="image-overlay">
								<p class="image-caption">{events[2].cardTitle}</p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>

		<!-- PHASE 2: FLOWING TIMELINE (UNCHANGED) -->
		<section class="timeline-section" id="timelineSection">
			<div class="timeline-header">
				<h1 class="timeline-title">The Journey</h1>
				<p class="timeline-subtitle">
					A flowing path through Triverse 3.0
				</p>
			</div>

			<div class="timeline-content">
				<!-- Organic S-Curve Path -->
				<div class="timeline-svg-stage">
					<svg
						class="timeline-svg"
						viewBox="0 0 100 1000"
						preserveAspectRatio="none"
					>
						<defs>
							<filter id="glow">
								<feGaussianBlur
									in="SourceGraphic"
									stdDeviation="2"
									result="coloredBlur"
								/>
								<feMerge>
									<feMergeNode in="coloredBlur" />
									<feMergeNode in="SourceGraphic" />
								</feMerge>
							</filter>
						</defs>
						<!-- Base Path (Dashed) -->
						<path
						d="M 50,0 Q 30,150 50,300 Q 70,450 50,600 Q 30,750 50,900"
						class="path-base"
					/>
					<!-- Animated Trace Path -->
					<path
						id="timelineMaskPath"
						d="M 50,0 Q 30,150 50,300 Q 70,450 50,600 Q 30,750 50,900"
						class="path-trace"
						filter="url(#glow)"
					/>
					<!-- Pulse Nodes -->
					<circle cx="50" cy="0" r="1.2" class="path-node" />
					<circle cx="50" cy="300" r="1.2" class="path-node" />
					<circle cx="50" cy="600" r="1.2" class="path-node" />
					<circle cx="50" cy="900" r="1.2" class="path-node" />
					</svg>
				</div>

				<!-- Milestones -->
				<div class="milestones-wrapper">
					{events.map((event) => (
						<div class="milestone-block">
							<div class="milestone-card" style={`--accent: ${event.color};`}>
								<div class="card-glow"></div>
								<div class="card-body">
									{event.cardTitle && (<h3 class="card-title">{event.cardTitle}</h3>)}
									{event.cardSubtitle && (<p class="card-subtitle">{event.cardSubtitle}</p>)}
									{event.cardTitle && (<div class="card-divider"></div>)}
									
									{!event.cardTitle && event.title && (<h3>{event.title}</h3>)}
									{!event.cardTitle && event.date && (<span class="date">{event.date}</span>)}
									{!event.cardTitle && event.description && (<p>{event.description}</p>)}
									
									{event.objectiveTitle && (<h4 class="card-section-title">{event.objectiveTitle}</h4>)}
									{event.objective && (<p class="card-text">{event.objective}</p>)}
								</div>
								<div class="card-connector"></div>
							</div>
						</div>
					))}
				</div>
			</div>
		</section>
	</main>
</Layout>

<style is:global>
	:root {
		--bg-dark: #0a0e1a;
		--bg-darker: #060810;
		--purple-bright: #b48bff;
		--glass-border: rgba(255, 255, 255, 0.12);
	}

	body {
		background-color: var(--bg-dark);
		color: #ffffff;
		margin: 0;
		font-family:
			"Inter",
			system-ui,
			-apple-system,
			sans-serif;
		overflow-x: hidden;
	}
</style>

<style>
	.events-container {
		position: relative;
		width: 100%;
	}

	/* ==================== STATIC HERO (PHASE 1) ==================== */
	.hero-section {
		min-height: 120vh;
		padding: 80px 5vw 100px;
		background: linear-gradient(135deg, #0a0e1a 0%, #12111f 100%);
		position: relative;
		z-index: 40;
		display: flex;
		align-items: center;
		justify-content: center;
	}

	.hero-content {
		width: 100%;
		max-width: 1600px;
	}

	.hero-header {
		margin-bottom: 80px;
		text-align: center;
	}

	.hero-title {
		font-size: clamp(3rem, 12vw, 6rem);
		font-weight: 950;
		margin: 0 0 1rem 0;
		letter-spacing: -0.03em;
		background: linear-gradient(135deg, #ffffff 0%, #b48bff 100%);
		background-clip: text;
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
	}

	.hero-subtitle {
		font-size: clamp(1rem, 2.5vw, 1.5rem);
		color: #b48bff;
		margin: 0;
		opacity: 0.9;
		letter-spacing: 0.02em;
	}

	/* Staggered Bento Grid */
	.bento-grid {
		display: grid;
		grid-template-columns: repeat(3, 1fr);
		gap: clamp(24px, 4vw, 48px);
		width: 100%;
		align-items: start;
	}

	.bento-column {
		display: flex;
		flex-direction: column;
		gap: clamp(20px, 3vw, 36px);
	}

	/* Column 1 & 3: Standard offset */
	.col-1,
	.col-3 {
		margin-top: 0;
	}

	/* Column 2: Dominant center, slightly offset */
	.col-2 {
		margin-top: 60px;
	}

	/* Base Card Styles */
	.bento-card {
		position: relative;
		border-radius: 24px;
		overflow: hidden;
		cursor: pointer;
		transition: all 0.4s cubic-bezier(0.22, 1, 0.36, 1);
		background: rgba(20, 15, 40, 0.6);
		backdrop-filter: blur(12px);
		border: 1px solid rgba(255, 255, 255, 0.12);
	}

	.bento-card:hover {
		transform: translateY(-12px);
		box-shadow: 0 30px 80px rgba(180, 139, 255, 0.2);
		border-color: rgba(180, 139, 255, 0.4);
	}

	/* Text Cards */
	.text-card {
		padding: clamp(40px, 6vw, 60px);
		min-height: 240px;
		display: flex;
		align-items: center;
		justify-content: center;
		background: linear-gradient(135deg, rgba(168, 85, 247, 0.08) 0%, rgba(217, 70, 239, 0.05) 100%);
	}

	.text-card.small {
		min-height: 180px;
		padding: clamp(30px, 5vw, 45px);
	}

	.card-content {
		text-align: center;
		width: 100%;
	}

	.stat-number {
		font-size: clamp(2.8rem, 7vw, 4.5rem);
		font-weight: 900;
		background: linear-gradient(135deg, #b48bff 0%, #d946ef 100%);
		background-clip: text;
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
		line-height: 1;
		margin-bottom: 0.8rem;
	}

	.stat-label {
		font-size: clamp(0.95rem, 2vw, 1.3rem);
		color: rgba(255, 255, 255, 0.75);
		text-transform: uppercase;
		letter-spacing: 0.1em;
		font-weight: 600;
	}

	/* Image Cards */
	.image-card {
		position: relative;
		min-height: 280px;
		overflow: hidden;
		display: flex;
		align-items: center;
		justify-content: center;
	}

	.image-card.dominant {
		min-height: 420px;
		grid-row: span 1;
	}

	.image-card img {
		width: 100%;
		height: 100%;
		object-fit: cover;
		transition: transform 0.5s cubic-bezier(0.22, 1, 0.36, 1);
	}

	.bento-card:hover .image-card img {
		transform: scale(1.05);
	}

	/* Image Overlay Gradient */
	.image-overlay {
		position: absolute;
		inset: 0;
		background: linear-gradient(180deg, transparent 40%, rgba(10, 14, 26, 0.5) 100%);
		display: flex;
		align-items: flex-end;
		padding: clamp(20px, 4vw, 32px);
		opacity: 0;
		transition: opacity 0.4s ease;
	}

	.bento-card:hover .image-overlay {
		opacity: 1;
	}

	.image-caption {
		margin: 0;
		font-size: clamp(0.9rem, 1.8vw, 1.1rem);
		color: rgba(255, 255, 255, 0.9);
		font-weight: 600;
		line-height: 1.4;
	}

	/* Tablet: 2 Columns */
	@media (max-width: 1024px) {
		.bento-grid {
			grid-template-columns: repeat(2, 1fr);
			gap: clamp(20px, 3vw, 32px);
		}

		.col-2 {
			margin-top: 0;
		}

		/* Stagger on tablet */
		.col-2 {
			grid-column: span 1;
			margin-top: 40px;
		}
	}

	/* Mobile: 1 Column */
	@media (max-width: 768px) {
		.hero-section {
			min-height: auto;
			padding: 60px 4vw;
		}

		.hero-header {
			margin-bottom: 60px;
		}

		.bento-grid {
			grid-template-columns: 1fr;
			gap: clamp(16px, 2.5vw, 24px);
		}

		.bento-column {
			gap: clamp(16px, 2.5vw, 24px);
		}

		.col-1,
		.col-2,
		.col-3 {
			margin-top: 0;
		}

		.text-card {
			min-height: 200px;
		}

		.text-card.small {
			min-height: 160px;
		}

		.image-card {
			min-height: 240px;
		}

		.image-card.dominant {
			min-height: 280px;
		}

		.image-overlay {
			opacity: 1;
		}
	}

	/* ==================== TIMELINE (PHASE 2 - UNCHANGED) ==================== */
	.timeline-section {
		min-height: 150vh;
		padding: 25vh 5vw;
		background: var(--bg-dark);
		position: relative;
		z-index: 50;
		opacity: 1;
		transform: translateY(0);
		transition:
			opacity 1.2s ease,
			transform 1.2s ease;
	}

	@media (max-width: 768px) {
		.timeline-section {
			min-height: 80vh;
			padding: 15vh 5vw;
		}
	}

	.timeline-section.visible {
		opacity: 1;
		transform: translateY(0);
	}

	.timeline-header {
		text-align: center;
		margin-bottom: 25vh;
		position: relative;
		z-index: 2;
	}

	.timeline-title {
		font-size: clamp(3rem, 12vw, 7.5rem);
		font-weight: 950;
		letter-spacing: -0.05em;
		margin: 0;
		line-height: 0.9;
	}

	.timeline-subtitle {
		font-size: clamp(1.1rem, 2.5vw, 1.8rem);
		color: var(--purple-bright);
		margin-top: 15px;
		opacity: 0.9;
	}

	.timeline-content {
		position: relative;
		max-width: 1400px;
		margin: 0 auto;
		display: flex;
		justify-content: space-between;
	}

	.timeline-svg-stage {
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		pointer-events: none;
	}

	.timeline-svg {
		width: 100%;
		height: 100%;
	}

	.path-base {
		fill: none;
		stroke: rgba(168, 85, 247, 0.06);
		stroke-width: 0.8;
		stroke-linecap: round;
		stroke-dasharray: 4 8;
	}

	.path-trace {
		fill: none;
		stroke: var(--purple-bright);
		stroke-width: 1.5;
		stroke-linecap: round;
		stroke-dasharray: 8 12;
	}

	.path-node {
		filter: drop-shadow(0 0 5px var(--purple-bright));
		animation: nodePulse 2s infinite;
	}

	@keyframes nodePulse {
		0%,
		100% {
			r: 1.2;
			opacity: 0.6;
		}
		50% {
			r: 1.8;
			opacity: 1;
		}
	}

	.milestones-wrapper {
		width: 100%;
		display: flex;
		flex-direction: column;
		gap: 25vh;
		padding-top: 10vh;
	}

	.milestone-block {
		width: 100%;
		display: flex;
		opacity: 0;
		transform: translateY(80px);
		transition: all 1.2s cubic-bezier(0.16, 1, 0.3, 1);
	}

	.milestone-block:nth-child(odd) {
		justify-content: flex-start;
		padding-left: 2vw;
	}
	.milestone-block:nth-child(even) {
		justify-content: flex-end;
		padding-right: 2vw;
	}

	.milestone-block:nth-child(2) {
		margin-top: 5vh;
	}
	.milestone-block:nth-child(3) {
		margin-top: 5vh;
	}

	.milestone-block.revealed {
		opacity: 1;
		transform: translateY(0);
	}

	.milestone-card {
		width: min(520px, 90vw);
		padding: clamp(30px, 5vw, 50px);
		background: rgba(255, 255, 255, 0.03);
		backdrop-filter: blur(20px);
		border: 1px solid var(--glass-border);
		border-radius: 32px;
		position: relative;
		overflow: visible;
		transition:
			transform 0.5s cubic-bezier(0.16, 1, 0.3, 1),
			border-color 0.5s ease;
	}

	.milestone-card:hover {
		transform: translateY(-15px) scale(1.02);
		border-color: var(--accent);
		background: rgba(255, 255, 255, 0.05);
	}

	.card-body h3 {
		font-size: clamp(1.6rem, 4.5vw, 2.8rem);
		margin: 0 0 1vh 0;
		font-weight: 900;
		letter-spacing: -0.02em;
	}

	.card-body .date {
		display: block;
		font-size: 0.95rem;
		text-transform: uppercase;
		letter-spacing: 0.2em;
		color: var(--accent);
		margin-bottom: 2.5vh;
		font-weight: 700;
	}

	.card-body p {
		color: rgba(255, 255, 255, 0.65);
		line-height: 1.8;
		font-size: clamp(1rem, 1.8vw, 1.15rem);
		margin: 0;
	}

	.card-title {
		font-size: clamp(1.6rem, 4.5vw, 2.8rem);
		margin: 0 0 0.8vh 0;
		font-weight: 900;
		letter-spacing: -0.02em;
	}

	.card-subtitle {
		color: var(--purple-bright);
		font-weight: 600;
		letter-spacing: 0.04em;
		margin: 0 0 1.2vh 0;
	}

	.card-divider {
		width: 100%;
		height: 1px;
		background: rgba(255, 255, 255, 0.18);
		margin: 1.2vh 0 1.8vh;
	}

	.card-section-title {
		font-size: 1rem;
		color: var(--accent);
		text-transform: none;
		letter-spacing: 0.03em;
		margin: 0 0 0.6vh 0;
	}

	.card-text {
		color: rgba(255, 255, 255, 0.75);
		line-height: 1.8;
		font-size: clamp(1rem, 1.7vw, 1.1rem);
		margin: 0;
	}

	.card-connector {
		position: absolute;
		top: 50%;
		width: 60px;
		height: 1px;
		background: linear-gradient(90deg, var(--accent), transparent);
		opacity: 0.5;
	}

	.milestone-block:nth-child(odd) .card-connector {
		right: -60px;
	}
	.milestone-block:nth-child(even) .card-connector {
		left: -60px;
		transform: scaleX(-1);
	}

	@media (min-width: 1025px) {
		.milestone-block:nth-child(2) {
			padding-right: 5vw;
		}
		.milestone-block:nth-child(3) {
			padding-left: 5vw;
		}
	}

	@media (max-width: 1024px) {
		.milestone-block:nth-child(odd),
		.milestone-block:nth-child(even) {
			justify-content: center;
			padding: 0;
		}
		.card-connector {
			display: none;
		}
		.milestones-wrapper {
			gap: 20vh;
		}
	}
</style>

<script>
	// Timeline animation
	const timelineSection = document.getElementById("timelineSection");
	const timelineMaskPath = document.getElementById("timelineMaskPath") as SVGPathElement | null;
	const milestones = document.querySelectorAll(".milestone-block");

	let pathLength = 0;
	if (timelineMaskPath) {
		pathLength = timelineMaskPath.getTotalLength();
		timelineMaskPath.style.strokeDashoffset = `${pathLength}`;
	}

	const triggers = [0.05, 0.35, 0.7];

	// Show timeline on page load
	window.addEventListener("load", () => {
		if (timelineSection) {
			timelineSection.classList.add("visible");
		}
	});

	// Timeline trace on scroll
	window.addEventListener("scroll", () => {
		if (timelineSection && timelineMaskPath) {
			const sy = window.scrollY;
			const vh = window.innerHeight;
			const top = timelineSection.offsetTop;
			const h = timelineSection.offsetHeight;

			const scrollStart = top - vh * 0.4;
			const scrollEnd = top + h - vh * 1.6;
			const p = Math.max(
				0,
				Math.min(1, (sy - scrollStart) / (scrollEnd - scrollStart)),
			);

			timelineMaskPath.style.strokeDashoffset = (
				pathLength * (1 - p)
			).toString();

			milestones.forEach((m, i) => {
				if (p >= triggers[i]) m.classList.add("revealed");
				else m.classList.remove("revealed");
			});
		}
	});
</script>
