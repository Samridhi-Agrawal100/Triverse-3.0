---
// Hero section matching the reference image
import { Image } from "astro:assets";
import "../assets/hero.css";
import arcImage from "../images/arc.png";
import triLogo from "../images/Tri.png";
---

<div class="hero-container">
	<!-- Top Spotlight - Cone beam from top center -->
	<div class="top-spotlight" id="topSpotlight"></div>
	<div class="stars"></div>

	<!-- Bottom Purple Glow Arc -->
	<div class="bottom-glow-arc" id="bottomGlow"></div>

	<!-- Planet Arc Image -->
	<div class="planet-arc-wrapper">
		<Image
			src={arcImage}
			alt="Planet Arc"
			class="planet-arc"
			id="planetArc"
		/>
	</div>

	<!-- Logo and Text Container -->
	<div class="logo-text-container" id="logoContainer">
		<div class="logo-blend-wrapper">
			<div class="logo-wrapper">
				<Image src={triLogo} alt="Triverse Logo" class="tri-logo-img" />
				<h1 class="triverse-logo" id="triverseLogo">
					{
						"TRIVERSE"
							.split("")
							.map((char) => <span class="letter">{char}</span>)
					}
				</h1>
			</div>
		</div>
	</div>
</div>

<script is:inline>
	(function () {
		function initAnimations() {
			if (typeof window === "undefined" || !window.gsap) {
				setTimeout(initAnimations, 100);
				return;
			}

			const logoContainer = document.getElementById("logoContainer");
			const logoBlendWrapper = logoContainer?.querySelector(
				".logo-blend-wrapper",
			);
			const triverseLogo = document.getElementById("triverseLogo");
			const topSpotlight = document.getElementById("topSpotlight");
			const bottomGlow = document.getElementById("bottomGlow");
			const planetArc = document.getElementById("planetArc");

			if (
				!logoContainer ||
				!triverseLogo ||
				!topSpotlight ||
				!bottomGlow ||
				!planetArc
			) {
				setTimeout(initAnimations, 100);
				return;
			}

			const gsap = window.gsap;

			// Set blend mode for logo
			if (logoBlendWrapper) {
				logoBlendWrapper.style.mixBlendMode = "screen";
			}

			// Set initial states

			const logoImg = logoContainer.querySelector(".tri-logo-img");
			const letters = triverseLogo.querySelectorAll(".letter");

			// Set initial states
			gsap.set([logoContainer, topSpotlight, bottomGlow, planetArc], {
				opacity: 0,
			});

			gsap.set(logoImg, {
				opacity: 0,
				y: -100,
				rotationX: 90,
				skewX: -20,
				scale: 0.5,
				filter: "blur(10px)",
			});

			gsap.set(letters, {
				opacity: 0,
				y: -100,
				rotationX: 90,
				skewX: -20,
				scale: 0.5,
				filter: "blur(10px)",
			});

			gsap.set(topSpotlight, {
				scaleY: 0,
				transformOrigin: "top center",
			});

			gsap.set(bottomGlow, {
				scaleX: 0,
				transformOrigin: "center center",
			});

			gsap.set(planetArc, {
				scaleY: 0,
				transformOrigin: "bottom center",
			});

			// Create timeline
			const tl = gsap.timeline({ delay: 0.1 });

			// Animate bottom glow arc appearing
			tl.to(bottomGlow, {
				scaleX: 1,
				opacity: 1,
				duration: 1.2,
				ease: "power2.out",
			})
				// Animate planet arc rising
				.to(
					planetArc,
					{
						scaleY: 1,
						opacity: 1,
						duration: 1,
						ease: "power2.out",
					},
					"-=0.8",
				)
				// Animate top spotlight appearing
				.to(
					topSpotlight,
					{
						scaleY: 1,
						opacity: 1,
						duration: 1.5,
						ease: "power3.out",
					},
					"-=0.5",
				)
				// Fade in logo container
				.to(
					logoContainer,
					{
						opacity: 1,
						duration: 0.5,
					},
					"-=1.0",
				)
				// Animate logo image first
				.to(
					logoImg,
					{
						opacity: 1,
						y: 0,
						rotationX: 0,
						skewX: 0,
						scale: 1,
						filter: "blur(0px)",
						duration: 1,
						ease: "power3.out",
					},
					"-=0.5",
				)
				// Stagger animate letters
				.to(
					letters,
					{
						opacity: 1,
						y: 0,
						rotationX: 0,
						skewX: 0,
						scale: 1,
						filter: "blur(0px)",
						duration: 1,
						stagger: 0.05,
						ease: "power3.out",
					},
					"<",
				)
				.fromTo(
					".tagline",
					{ opacity: 0, y: 10 },
					{ opacity: 1, y: 0, duration: 1, ease: "power2.out" },
					"-=0.5",
				);

			// Start floating animation after fade in
			gsap.to(triverseLogo, {
				y: -15,
				duration: 4,
				repeat: -1,
				yoyo: true,
				ease: "sine.inOut",
				delay: 2.5,
			});

			// Subtle spotlight pulse
			gsap.to(topSpotlight, {
				opacity: 0.85,
				duration: 3,
				repeat: -1,
				yoyo: true,
				ease: "sine.inOut",
				delay: 2,
			});
		}

		if (document.readyState === "loading") {
			document.addEventListener("DOMContentLoaded", initAnimations);
		} else {
			initAnimations();
		}
	})();
</script>

<style>
	.logo-wrapper {
		display: flex;
		align-items: center;
		justify-content: center;
		gap: 20px;
	}

	.tri-logo-img {
		height: clamp(4rem, 10vw, 8rem);
		width: auto;
		object-fit: contain;
		margin-bottom: 5px;
	}

	@media (max-width: 768px) {
		.logo-wrapper {
			flex-direction: column;
			gap: 10px;
		}

		.tri-logo-img {
			height: clamp(2.5rem, 6vw, 4rem);
		}
	}
</style>
